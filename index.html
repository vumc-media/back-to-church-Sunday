<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Back to Church Sunday — Versailles UMC</title>
  <meta name="description" content="You're invited! Join us this Sunday at Versailles UMC. Watch a short welcome from our pastors, then tap to see what's next." />
  <meta name="theme-color" content="#0b5fff" />
  <style>
    :root{ --brand:#0b5fff; --bg:#0b1220; --text:#f6f8ff; --muted:#b7c2e1; --radius:18px; }
    html,body{height:100%}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      color:var(--text);
      background: radial-gradient(1200px 500px at 50% -10%, #20305c66 0%, transparent 60%), linear-gradient(#0b1220,#0a1020);
      -webkit-font-smoothing:antialiased; line-height:1.6; display:flex; flex-direction:column; min-height:100vh
    }
    header{padding:20px 16px 8px; text-align:center}
    h1{margin:0; font-size:clamp(1.25rem,1rem + 1.2vw,2rem); letter-spacing:.2px}
    .sub{color:var(--muted); font-size:.95rem; margin-top:2px}
    .wrap{width:min(1100px,92vw); margin:0 auto; padding:8px 0 36px; flex:1}

    .player-box{position:relative; aspect-ratio:16/9; background:#000; border-radius:var(--radius); overflow:hidden; box-shadow:0 10px 40px #0008}
    #player{position:absolute; inset:0}
    .start{position:absolute; inset:0; display:flex; align-items:center; justify-content:center; background: linear-gradient(180deg,#0008,#0004)}
    .play{appearance:none; border:0; background:white; color:#000; width:74px; height:74px; border-radius:50%; display:grid; place-items:center; box-shadow:0 10px 30px #0008; cursor:pointer}
    .play:after{content:""; width:0; height:0; border-left:20px solid #000; border-top:14px solid transparent; border-bottom:14px solid transparent; margin-left:4px}
    .helper{margin:10px 2px 0; font-size:.9rem; color:#c9d5ff99; text-align:center}
    .helper a{color:#dbe6ff; font-weight:600}

    /* CTA overlay slides up from bottom of player */
    .cta{position:absolute; inset:auto 0 0 0; transform:translateY(100%); opacity:0; pointer-events:none; transition:.5s ease}
    .cta.show{transform:translateY(0); opacity:1; pointer-events:auto}
    .cta .card{
      background: linear-gradient(180deg,#0b1220cc,#0b1220ee 60%,#0b1220ff),
                  radial-gradient(800px 300px at 50% -10%, #345 0%, transparent 60%);
      backdrop-filter: blur(6px); -webkit-backdrop-filter: blur(6px);
      border-top-left-radius:var(--radius); border-top-right-radius:var(--radius);
      padding:18px 16px 20px; border:1px solid #2a3a66
    }
    .card h2{margin:0 0 4px; font-size:clamp(1.1rem,.9rem + .9vw,1.6rem)}
    .card p{margin:0 0 12px; color:var(--muted)}
    .buttons{display:grid; grid-template-columns:1fr; gap:10px}
    .btn{display:flex; align-items:center; justify-content:center; gap:10px; text-decoration:none; color:white; font-weight:700; padding:14px 16px; border-radius:12px; border:1px solid #2a3a66; background:#14224a; transition:.2s ease; text-align:center}
    .btn:hover{transform:translateY(-1px); box-shadow:0 6px 18px #0005}
    .btn.primary{background:linear-gradient(180deg,var(--brand),#0a4fe0); border-color:#0a49d5}

    footer{padding:22px 16px 40px; text-align:center; color:#9fb0da; font-size:.9rem}
  </style>
</head>
<body>
  <header>
    <h1>Back to Church Sunday</h1>
    <div class="sub">A quick hello from our pastors — then tap to see what’s next at VUMC.</div>
  </header>

  <main class="wrap">
    <section class="player-box" aria-label="Invitation Video">
      <div id="player"></div>
      <div class="start" id="starter">
        <button class="play" id="playBtn" aria-label="Play video"></button>
        <span class="sr-only">Tap play to watch the invitation video</span>
      </div>

      <!-- CTA Overlay -->
      <div class="cta" id="cta">
        <div class="card">
          <h2>You're invited — what's next?</h2>
          <p>Plan your visit, explore groups, and see what’s happening at Versailles UMC.</p>
          <div class="buttons">
            <a id="ctaBtn" class="btn primary" href="#" role="button" aria-label="See What's Happening">See What’s Happening</a>
          </div>
        </div>
      </div>
    </section>

    <p class="helper">Trouble with the embed? <a id="ytOpen" target="_blank" rel="noopener">Open in YouTube</a>.</p>
  </main>

  <footer>
    <div>Questions? <a href="mailto:info@versaillesumc.org" style="color:#dbe6ff">Email us</a>. Sunday services: 9:30a (Traditional) & 10:30a (Contemporary).</div>
  </footer>

  <script>
    // ====== CONFIG ======
    const CONFIG = {
      youtubeId: "dP0UPvlghVo",  // replace with your final video ID if needed
      showCtaAtSeconds: 35,       // set 0 to show CTA immediately
      ctaUrl: "https://connect.versaillesumc.org/back-to-church-sunday",
      defaultUtm: { utm_source: 'doorhanger', utm_medium: 'qr', utm_campaign: 'back_to_church_2025' }
    };

    // ====== UTILS ======
    function withParams(url, params){
      const u = new URL(url);
      Object.entries(params).forEach(([k,v]) => { if(v!=null && v!=="") u.searchParams.set(k, v) });
      return u.toString();
    }

    const inbound = new URL(location.href);
    const tracking = {
      utm_source: inbound.searchParams.get('utm_source') || inbound.searchParams.get('src') || CONFIG.defaultUtm.utm_source,
      utm_medium: inbound.searchParams.get('utm_medium') || CONFIG.defaultUtm.utm_medium,
      utm_campaign: inbound.searchParams.get('utm_campaign') || CONFIG.defaultUtm.utm_campaign
    };

    // Wire CTA link with tracking
    const ctaBtn = document.getElementById('ctaBtn');
    ctaBtn.href = withParams(CONFIG.ctaUrl, tracking);

    // Helper link to open YouTube in new tab or app
    const ytHref = `https://youtu.be/${CONFIG.youtubeId}`;
    document.getElementById('ytOpen').href = ytHref;

    // ====== Player Mount (on click only; Safari-friendly) ======
    const starter = document.getElementById('starter');
    const playBtn = document.getElementById('playBtn');
    const playerHost = document.getElementById('player');
    const cta = document.getElementById('cta');
    let ctaShown = false;

    function revealCTA(){
      if (ctaShown) return;
      cta.classList.add('show');
      ctaShown = true;
    }

    function mountYouTube(){
      // Use privacy-enhanced domain, no autoplay (reduces cookie prompts)
      const iframe = document.createElement('iframe');
      iframe.src = `https://www.youtube-nocookie.com/embed/${CONFIG.youtubeId}?rel=0&modestbranding=1&playsinline=1`;
      iframe.title = 'YouTube video player';
      iframe.frameBorder = '0';
      iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share';
      iframe.allowFullscreen = true;
      iframe.style.width='100%';
      iframe.style.height='100%';
      playerHost.appendChild(iframe);

      // Time-based CTA reveal
      const secs = Number(CONFIG.showCtaAtSeconds || 0);
      if (secs > 0) setTimeout(revealCTA, secs * 1000);

      // Fallback: if iframe doesn't load quickly (strict cookies), open YouTube directly
      let loaded = false;
      const t = setTimeout(()=>{ if(!loaded){ window.open(ytHref,'_blank','noopener'); } }, 2500);
      iframe.addEventListener('load', ()=>{ loaded = true; clearTimeout(t); });
    }

    playBtn.addEventListener('click', ()=>{
      starter.style.display='none';
      mountYouTube();
    });

    // If you prefer the CTA always visible, uncomment:
    // cta.classList.add('show');
  </script>
</body>
</html>
